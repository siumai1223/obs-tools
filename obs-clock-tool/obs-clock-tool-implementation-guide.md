# 🕒 リアルタイム時計・日付表示ツール 実装ガイド

## 概要
OBS Studio上にリアルタイムで時計・日付を表示するツールの詳細実装手順書。
OBS WebSocket APIの基本操作を学習しながら、段階的に機能を実装する。

## 📋 事前決定事項

### 1. 技術スタック選択
- **推奨**: Python + obs-websocket-py
- **理由**: 学習コストが低く、ライブラリが豊富
- **代替案**: JavaScript + Node.js

### 2. 表示フォーマット設計
以下から選択または組み合わせ：
- [ ] 2025-05-27 14:30:25 (ISO形式)
- [ ] 2025年5月27日 午後2時30分25秒 (日本語)
- [ ] May 27, 2025 2:30:25 PM (英語)
- [ ] 14:30:25 (時刻のみ)
- [ ] 2025/05/27 (日付のみ)

### 3. 更新頻度
- **推奨**: 1秒間隔
- **選択肢**: 0.5秒、1秒、5秒

### 4. OBS表示方法
- **テキストソース**: シンプルなテキスト表示
- **ブラウザソース**: HTML/CSSでリッチな表示

## 🛠️ 実装手順（ステップバイステップ）

### Step 1: 環境構築 (15分)

#### 1.1 必要なソフトウェアインストール
- [ ] Python環境確認 (3.8以上推奨)
- [ ] 必要なライブラリインストール
  - [ ] obs-websocket-py
  - [ ] python-dateutil
  - [ ] pytz (タイムゾーン対応)

#### 1.2 OBS設定
- [ ] OBS Studio起動
- [ ] **ツール** → **WebSocket Server Settings**
- [ ] **Enable WebSocket server** にチェック
- [ ] **Server Port**: 4455 (デフォルト)
- [ ] **Server Password**: 任意のパスワード設定
- [ ] **Apply** → **OK**

#### 1.3 OBSにテキストソース追加
- [ ] **ソース** → **+** → **テキスト (GDI+)**
- [ ] 名前: "Clock" (後でコードから参照)
- [ ] **OK** → 適当なテキスト入力 → **OK**

### Step 2: 基本プロトタイプ作成 (30分)

#### 2.1 プロジェクト構造作成
```
obs-clock-tool/
├── main.py
├── config.json
└── requirements.txt
```

#### 2.2 基本コード実装
- [ ] requirements.txt作成
- [ ] config.json設定ファイル作成
- [ ] main.py基本クラス実装
  - [ ] OBS接続管理
  - [ ] 時刻取得・フォーマット
  - [ ] テキストソース更新
  - [ ] メインループ

#### 2.3 実装する主要機能
- [ ] OBSClockToolクラス作成
- [ ] connect_obs() - OBS接続
- [ ] disconnect_obs() - OBS切断
- [ ] get_current_time() - 現在時刻取得
- [ ] update_clock_text() - テキスト更新
- [ ] run() - メインループ

### Step 3: 動作確認 (10分)

#### 3.1 設定ファイル編集
- [ ] config.jsonのパスワードを実際のOBSパスワードに変更
- [ ] ソース名が正しいか確認

#### 3.2 実行テスト
- [ ] プログラム実行
- [ ] 期待される動作確認
  - [ ] コンソールに「OBSに接続しました」表示
  - [ ] 1秒ごとに時刻がコンソールとOBSに表示
  - [ ] Ctrl+Cで正常終了

### Step 4: 機能拡張 (60分)

#### 4.1 複数フォーマット対応
- [ ] config.json拡張
- [ ] 複数ソース対応
- [ ] 異なるフォーマットの同時表示

#### 4.2 エラーハンドリング強化
- [ ] 再試行機能実装
- [ ] 接続失敗時の対応
- [ ] タイムアウト処理

#### 4.3 ログ機能追加
- [ ] ログ設定
- [ ] ファイル出力
- [ ] コンソール出力
- [ ] ログレベル設定

#### 4.4 追加機能実装
- [ ] タイムゾーン切り替え
- [ ] カスタムフォーマット
- [ ] 更新間隔調整
- [ ] 自動再接続

### Step 5: 設定UI作成 (オプション・60分)

#### 5.1 GUI設計
- [ ] tkinterを使用した簡単なGUI
- [ ] 設定入力フォーム
- [ ] 制御ボタン
- [ ] ステータス表示

#### 5.2 GUI機能実装
- [ ] ClockToolGUIクラス作成
- [ ] ウィジェット作成
- [ ] イベントハンドリング
- [ ] スレッド管理

#### 5.3 GUI機能
- [ ] OBS接続設定入力
- [ ] 開始/停止ボタン
- [ ] ステータス表示
- [ ] リアルタイム設定変更

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. OBS接続エラー
**症状**: `ConnectionRefusedError: [Errno 61] Connection refused`
**解決方法**:
- [ ] OBS WebSocketプラグインが有効か確認
- [ ] ポート番号が正しいか確認
- [ ] ファイアウォール設定確認

#### 2. ソースが見つからないエラー
**症状**: `obs-websocket error: source not found`
**解決方法**:
- [ ] OBSでテキストソース名を確認
- [ ] config.jsonのsource_nameを正確に設定

#### 3. 文字化け
**解決方法**:
- [ ] config.jsonをUTF-8で保存
- [ ] Pythonファイルの先頭にエンコーディング指定追加

#### 4. パフォーマンス問題
**解決方法**:
- [ ] 更新間隔を調整
- [ ] 不要な処理を削減
- [ ] メモリリークチェック

## 📁 ファイル構成

### 最終的なプロジェクト構造
```
obs-clock-tool/
├── src/
│   ├── main.py              # メインプログラム
│   ├── obs_client.py        # OBS接続管理
│   ├── clock_formatter.py   # 時刻フォーマット
│   └── gui.py              # GUI (オプション)
├── config/
│   ├── config.json         # 設定ファイル
│   └── formats.json        # フォーマット定義
├── logs/
│   └── obs_clock.log       # ログファイル
├── tests/
│   └── test_clock.py       # テストコード
├── docs/
│   └── README.md          # ドキュメント
├── requirements.txt        # 依存関係
└── setup.py               # インストーラー
```

## 📊 実装チェックリスト

### 基本機能
- [ ] OBS WebSocket接続
- [ ] リアルタイム時刻表示
- [ ] 設定ファイル読み込み
- [ ] エラーハンドリング
- [ ] ログ出力

### 拡張機能
- [ ] 複数フォーマット対応
- [ ] タイムゾーン切り替え
- [ ] GUI設定画面
- [ ] 自動再接続
- [ ] カスタムスタイル

### 品質保証
- [ ] エラーケーステスト
- [ ] パフォーマンステスト
- [ ] ユーザビリティテスト
- [ ] ドキュメント整備

## 📈 次のステップ

### 1. 動作確認完了後の拡張
- [ ] システム情報モニターへの拡張
- [ ] 複数タイムゾーン対応
- [ ] カスタムフォント・色設定
- [ ] アニメーション効果

### 2. 学習ポイント
- [ ] OBS WebSocket APIの理解
- [ ] リアルタイム処理の実装
- [ ] 設定管理の方法
- [ ] エラーハンドリングのベストプラクティス

### 3. 他ツールへの応用
- [ ] システム情報モニター
- [ ] 天気情報表示
- [ ] 音楽再生情報表示

## 📝 開発メモ

### 実装時の注意点
- [ ] OBS WebSocketのバージョン互換性
- [ ] 文字エンコーディングの統一
- [ ] メモリリークの防止
- [ ] 例外処理の適切な実装

### パフォーマンス考慮事項
- [ ] 更新頻度の最適化
- [ ] 不要な文字列生成の削減
- [ ] 接続プールの活用
- [ ] キャッシュ機能の実装

---

**作成日**: 2025-05-27  
**更新日**: 2025-05-27  
**バージョン**: 1.0  
**推定実装時間**: 2-4時間 (基本機能)、6-8時間 (全機能)